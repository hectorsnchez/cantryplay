<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cantry - Juegos Online</title>

  <!-- Montserrat 500 + 700 (Bold) -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary:#6e5ad5;
      --primary-dark:#5a48c7;
      --bg:#6e5ad5;
      --card:#ffffff;
      --chip:#f1f1f1;
      --shadow:0 12px 28px rgba(0,0,0,.18);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:'Montserrat',system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background:var(--bg);
      color:#222;
      overflow-x:hidden;
    }

    header{
      position:fixed;
      inset:20px 0 auto 0;
      display:flex;
      justify-content:center;
      z-index:1000;
      pointer-events:none;
    }
    .header-inner{
      pointer-events:auto;
      display:flex;
      align-items:center;
      gap:18px;
      background:var(--card);
      padding:14px 20px;
      border-radius:20px;
      box-shadow:var(--shadow);
      width:min(950px,85vw);
      animation:fadeDown .45s ease;
      justify-content:center;
    }
    .logo{height:42px;width:auto;display:block}

    /* ðŸ”Ž Buscador */
    .search-wrap{flex:1;display:flex;justify-content:center}
    .search-input{
      width:min(560px,100%);
      padding:10px 14px;
      border:1px solid #ccc;
      border-radius:30px;
      background:#fff;
      font-size:16px;transition:all .25s ease;
    }
    .search-input:focus{outline:none;transform:scale(1.03);box-shadow:0 0 12px rgba(110,90,213,.45)}

    .search-popover{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      top:calc(100% + 8px);
      width:min(560px,100%);
      background:#fff;
      border-radius:14px;
      border:1px solid #ccc;
      box-shadow:0 14px 34px rgba(0,0,0,.15);
      padding:12px;
      display:none;
      animation:fadeIn .2s ease; 
    }

    .chip-row{display:flex;flex-wrap:wrap;gap:8px}
    .chip{padding:6px 14px;border-radius:20px;background:var(--chip);cursor:pointer;transition:transform .15s,background .2s}
    .chip:hover{transform:translateY(-1px)}
    .chip.active{background:var(--primary);color:#fff}
    .pop-sep{height:1px;background:#e9e9e9;margin:10px 0}
    .workers-link{display:flex;align-items:center;gap:8px;justify-content:center;color:var(--primary);text-decoration:underline;cursor:pointer}
    .lock-ico{width:18px;height:18px;display:inline-block}

    main{padding-top:120px}
    .games-grid{
      display:grid;gap:18px;padding:18px 20px 32px;
      grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
      grid-auto-rows:160px;
    }

    /* ðŸŽ® Tarjetas cuadradas */
    .game{
      position:relative;
      border-radius:20px;
      overflow:hidden;
      cursor:pointer;
      aspect-ratio:1/1;
      transition:transform .25s ease, box-shadow .25s ease
    }
    .game img,
    .game video.preview{
      width:100%;height:100%;
      object-fit:cover;
      display:block;
    }
    .game:hover{transform:translateY(-3px);box-shadow:0 18px 44px rgba(0,0,0,.35)}

    /* âœ… Nombre con sombra en vez de rectÃ¡ngulo */
    .name-badge{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      bottom:-36px;
      opacity:0;
      color:#fff;
      font-weight:700;
      font-size:14px;
      text-shadow: 0 2px 6px rgba(0,0,0,0.8);
      transition:bottom .22s ease,opacity .22s ease;
      pointer-events:none;
    }
    .game:hover .name-badge{bottom:12px;opacity:1}

    .game video.preview{
      position:absolute;
      top:0;left:0;
      width:100%;height:100%;
      object-fit:cover;
      display:none;
    }

    /* ðŸŸ¦ TamaÃ±os cuadrados */
    .size-sm{grid-column:span 1;grid-row:span 1}
    .size-md{grid-column:span 2;grid-row:span 2}
    .size-lg{grid-column:span 3;grid-row:span 3}

    /* ðŸ”’ Paneles y modales mantienen igual */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;justify-content:center;align-items:center;z-index:1200}
    .modal-card{background:#fff;width:82vw;height:82vh;max-width:1200px;border-radius:20px;padding:10px;display:flex;flex-direction:column;animation:zoomIn .35s ease}
    .modal-card.hide{animation:zoomOut .32s ease forwards}
    .modal-top{display:flex;justify-content:flex-end;gap:10px}
    .icon-btn{background:var(--primary);color:#fff;border:none;border-radius:10px;padding:6px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .2s, background .2s}
    .icon-btn:hover{transform:scale(1.08);background:var(--primary-dark)}
    .modal-iframe{flex:1;border-radius:14px;border:none}

    .workers-panel{position:fixed;inset:0;background:rgba(0,0,0,.8);display:none;justify-content:center;align-items:center;z-index:1500}
    .panel{background:#fff;border-radius:20px;width:min(900px,92vw);max-height:92vh;overflow:auto;padding:20px;animation:zoomIn .35s ease}

    .panel h2 img{height:40px;vertical-align:middle;margin-right:8px}
    input,select{width:100%;margin:6px 0 10px;padding:10px;border-radius:12px;border:1px solid #d8d8d8;font-family:'Montserrat',sans-serif}
    button{background:var(--primary);color:#fff;border:none;border-radius:12px;padding:10px 14px;cursor:pointer}
    button:hover{background:var(--primary-dark)}

    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    @keyframes fadeDown{from{opacity:0;transform:translate(-50%,-18px)}to{opacity:1;transform:translate(-50%,0)}}
    @keyframes zoomIn{from{opacity:0;transform:scale(.92)}to{opacity:1;transform:scale(1)}}
    @keyframes zoomOut{from{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.92)}}

    /* ðŸ”˜ BotÃ³n flotante */
    .info-btn{
      position:fixed;
      bottom:20px;
      right:20px;
      width:48px;
      height:48px;
      border-radius:50%;
      background:var(--primary);
      color:#fff;
      font-weight:bold;
      font-size:20px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      box-shadow:0 6px 18px rgba(0,0,0,0.3);
      z-index:2000;
      user-select:none;
    }

    /* ðŸ“„ Ventana info */
    .info-window{
      position:fixed;
      bottom:80px;
      right:20px;
      width:300px;
      max-width:90vw;
      background:var(--primary);
      color:#fff;
      border-radius:14px;
      padding:16px;
      box-shadow:0 12px 28px rgba(0,0,0,.4);
      display:none;
      z-index:2001;
      animation:fadeIn .3s ease;
    }
    .info-window .close{
      position:absolute;
      top:8px;
      right:12px;
      cursor:pointer;
      font-size:18px;
      font-weight:bold;
    }
    .info-window p{
      margin:0;
      margin-top:12px;
      font-size:14px;
      line-height:1.4;
    }
  </style>
</head>
<body>

  <header>
    <div class="header-inner">
      <img src="logo.png" alt="Cantry" class="logo" />
      <div class="search-wrap">
        <!-- ðŸ”Ž Input sin icono -->
        <input id="searchInput" type="text" class="search-input" placeholder="Buscar juegos..." autocomplete="off" />
        <div id="searchPopover" class="search-popover" aria-hidden="true">
          <div id="chipRow" class="chip-row"></div>
          <div class="pop-sep"></div>
          <div id="workersLink" class="workers-link">
            <svg class="lock-ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V8a5 5 0 0 1 10 0v3"/></svg>
            <span>Acceso Privado</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <section id="grid" class="games-grid"></section>
  </main>

  <!-- ðŸŸ£ BotÃ³n flotante info -->
  <div class="info-btn" id="infoBtn">i</div>
  <div class="info-window" id="infoWindow">
    <div class="close" id="closeInfo">âœ•</div>
    <p>
      Si le has dado a este botÃ³n, gracias. Me llamo HÃ©ctor SÃ¡nchez y tengo 14 aÃ±os.  
      Esta pÃ¡gina fue creada con el propÃ³sito de que se puedan jugar a juegos en los institutos y colegios, que suelen bloquear las pÃ¡ginas de juegos.  
      VerÃ¡s que hay anuncios, y la verdad, es que muchos. No puedo controlar los que aparecen en los juegos ya que los juegos no los he creado yo, sino desarrolladores externos de GameMonetize.  
      Y sÃ­, gano algo cada vez que te aparece uno. Quiero donar mayor parte de los ingresos a fundaciones u ONGs, y ahora mismo me gustarÃ­a donar algo a palestina.  
      Aunque los anuncios que aparecen son demasiados y me gustarÃ­a quitar muchos de ellos.  
      Gracias por leerlo y espero que puedas disfrutar la web.
    </p>
  </div>

  <div id="gameModal" class="modal" aria-hidden="true">
    <div id="modalCard" class="modal-card">
      <div class="modal-top">
        <button id="btnClose" class="icon-btn" title="Cerrar" aria-label="Cerrar">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18M6 6l12 12"/></svg>
        </button>
        <button id="btnFull" class="icon-btn" title="Pantalla completa" aria-label="Pantalla completa">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 9V4h5M20 9V4h-5M4 15v5h5M20 15v5h-5"/></svg>
        </button>
      </div>
      <iframe id="gameFrame" class="modal-iframe" allowfullscreen></iframe>
    </div>
  </div>

  <div id="workersPanel" class="workers-panel" aria-hidden="true">
    <div class="panel">
      <h2><img src="logo.png" alt="Cantry"/> Acceso Privado</h2>
      <div id="workersLogin">
        <p>Introduce cÃ³digo de acceso:</p>
        <input type="password" id="codeInput" inputmode="numeric" placeholder="Introducir contraseÃ±a" />
        <button id="btnEnter">Entrar</button>
      </div>

      <div id="adminPanel" style="display:none">
        <h3>GestiÃ³n de juegos</h3>
        <input type="text" id="gameName" placeholder="Nombre del juego" />
        <input type="text" id="gameImg" placeholder="URL de la imagen" />
        <input type="text" id="gameVideo" placeholder="Nombre del archivo de video (opcional)" />
        <input type="text" id="gameEmbed" placeholder="URL embed" />
        <select id="gameCategory"></select>
        <select id="gameSize">
          <option value="pequeÃ±o">PequeÃ±o</option>
          <option value="mediano">Mediano</option>
          <option value="grande">Grande</option>
        </select>
        <button id="btnAddGame">AÃ±adir juego</button>

        <hr />
        <h3>GestiÃ³n de categorÃ­as</h3>
        <input type="text" id="newCategory" placeholder="Nueva categorÃ­a" />
        <button id="btnAddCat">AÃ±adir categorÃ­a</button>
        <div id="categoriesList"></div>

        <hr />
        <h3>Juegos actuales</h3>
        <div id="gamesList"></div>
      </div>
    </div>
  </div>

  <script>
    let games = JSON.parse(localStorage.getItem('games') || '[]');
    let categories = JSON.parse(localStorage.getItem('categories') || '["AcciÃ³n","Aventura","Puzzle","Deportes","Estrategia"]');
    let activeCategory = 'Todos';

    const grid = document.getElementById('grid');
    const searchInput = document.getElementById('searchInput');
    const popover = document.getElementById('searchPopover');
    const chipRow = document.getElementById('chipRow');
    const workersLink = document.getElementById('workersLink');

    const workersPanel = document.getElementById('workersPanel');
    const workersLogin = document.getElementById('workersLogin');
    const adminPanel  = document.getElementById('adminPanel');

    const gameFrame  = document.getElementById('gameFrame');
    const gameModal  = document.getElementById('gameModal');
    const modalCard  = document.getElementById('modalCard');
    const btnClose   = document.getElementById('btnClose');
    const btnFull    = document.getElementById('btnFull');

    const infoBtn = document.getElementById("infoBtn");
    const infoWindow = document.getElementById("infoWindow");
    const closeInfo = document.getElementById("closeInfo");

    infoBtn.addEventListener("click", ()=>{ infoWindow.style.display="block"; });
    closeInfo.addEventListener("click", ()=>{ infoWindow.style.display="none"; });

    const save = () => {
      localStorage.setItem('games', JSON.stringify(games));
      localStorage.setItem('categories', JSON.stringify(categories));
    }

    function sizeClass(sz){
      if(sz === 'grande') return 'size-lg';
      if(sz === 'mediano') return 'size-md';
      return 'size-sm';
    }

    function renderChips(){
      chipRow.innerHTML = '';
      const all = document.createElement('span');
      all.className = 'chip' + (activeCategory==='Todos'?' active':'');
      all.textContent = 'Todos';
      all.addEventListener('click',()=>{activeCategory='Todos';updateFilterUI();});
      chipRow.appendChild(all);
      categories.forEach(cat=>{
        const el = document.createElement('span');
        el.className = 'chip' + (activeCategory===cat?' active':'');
        el.textContent = cat;
        el.addEventListener('click',()=>{activeCategory=cat;updateFilterUI();});
        chipRow.appendChild(el);
      });
    }

    function filteredGames(){
      const term = searchInput.value.trim().toLowerCase();
      return games.filter(g => {
        const okCat = (activeCategory==='Todos' || g.category === activeCategory);
        const okText = term === '' || g.name.toLowerCase().includes(term) || (g.category||'').toLowerCase().includes(term);
        return okCat && okText;
      });
    }

    function renderGrid(){
      grid.innerHTML = '';
      filteredGames().forEach((g, i)=>{
        const card = document.createElement('div');
        card.className = `game ${sizeClass(g.size)}`;
        card.innerHTML = `
          <img src="${g.img}" alt="${g.name}" class="thumb">
          ${g.video ? `<video class="preview" src="${g.video}" loop muted></video>` : ""}
          <div class='name-badge'>${g.name}</div>
        `;
        card.addEventListener('click', ()=> openGame(g.embed));
        if(g.video){
          card.addEventListener('mouseenter', ()=>{
            const v = card.querySelector('.preview');
            v.style.display='block';
            v.play();
          });
          card.addEventListener('mouseleave', ()=>{
            const v = card.querySelector('.preview');
            v.pause();
            v.currentTime=0;
            v.style.display='none';
          });
        }
        grid.appendChild(card);
      });
    }

    function updateFilterUI(){
      renderChips();
      renderGrid();
    }

    const showPopover = () => {popover.style.display='block'};
    const hidePopover = () => {popover.style.display='none'};

    searchInput.addEventListener('focus', showPopover);
    searchInput.addEventListener('input', ()=>{ renderGrid(); });

    document.addEventListener('mousedown', (e)=>{
      const within = e.target.closest('.header-inner');
      if(!within) hidePopover();
    });

    workersLink.addEventListener('click', ()=>{ workersPanel.style.display='flex'; hidePopover(); });

    document.getElementById('btnEnter').addEventListener('click', ()=>{
      const code = document.getElementById('codeInput').value;
      if(code === '2729'){
        workersLogin.style.display='none';
        adminPanel.style.display='block';
        renderAdminLists();
      }else{
        alert('CÃ³digo incorrecto');
      }
    });

    workersPanel.addEventListener('click', (e)=>{
      if(e.target === workersPanel){ workersPanel.style.display='none'; }
    });

    document.getElementById('btnAddGame').addEventListener('click', ()=>{
      const name = document.getElementById('gameName').value.trim();
      const img  = document.getElementById('gameImg').value.trim();
      const vid  = document.getElementById('gameVideo').value.trim();
      const emb  = document.getElementById('gameEmbed').value.trim();
      const cat  = document.getElementById('gameCategory').value;
      const sz   = document.getElementById('gameSize').value;
      if(!name || !img || !emb){ alert('Completa nombre, imagen y embed'); return; }
      games.push({name: name, img: img, video: vid, embed: emb, category: cat, size: sz});
      save();
      renderGrid();
      renderAdminLists();
    });

    function renderAdminLists(){
      const sel = document.getElementById('gameCategory');
      sel.innerHTML = '';
      categories.forEach(c=>{
        const o = document.createElement('option'); o.value=c; o.textContent=c; sel.appendChild(o);
      });

      const catList = document.getElementById('categoriesList');
      catList.innerHTML='';
      categories.forEach((c,idx)=>{
        const row = document.createElement('div');
        row.style.margin = '6px 0';
        row.innerHTML = `${c} <button data-i='${idx}' class='delCat'>Eliminar</button>`;
        catList.appendChild(row);
      });
      catList.querySelectorAll('.delCat').forEach(btn=>{
        btn.addEventListener('click', (e)=>{
          const i = +e.target.getAttribute('data-i');
          const removed = categories.splice(i,1)[0];
          games = games.map(g=> g.category===removed ? {...g, category:'AcciÃ³n'} : g);
          save();
          renderChips();
          renderGrid();
          renderAdminLists();
        });
      });

      const list = document.getElementById('gamesList');
      list.innerHTML='';
      games.forEach((g,i)=>{
        const row = document.createElement('div');
        row.style.margin = '6px 0';
        row.innerHTML = `<b>${g.name}</b> â€“ ${g.category} â€“ ${g.size} <button data-i='${i}' class='delGame'>Eliminar</button>`;
        list.appendChild(row);
      });
      list.querySelectorAll('.delGame').forEach(btn=>{
        btn.addEventListener('click', (e)=>{
          const i = +e.target.getAttribute('data-i');
          games.splice(i,1);
          save();
          renderGrid();
          renderAdminLists();
        });
      });
    }

    document.getElementById('btnAddCat').addEventListener('click', ()=>{
      const val = document.getElementById('newCategory').value.trim();
      if(!val) return;
      if(!categories.includes(val)){
        categories.push(val);
        save();
        renderChips();
        renderAdminLists();
      }
    });

    function openGame(embed){
      gameFrame.src = embed;
      gameModal.style.display='flex';
      modalCard.classList.remove('hide');
    }
    btnClose.addEventListener('click', ()=>{
      modalCard.classList.add('hide');
      setTimeout(()=>{ gameModal.style.display='none'; gameFrame.src=''; modalCard.classList.remove('hide'); }, 320);
    });
    btnFull.addEventListener('click', ()=>{
      if(gameFrame.requestFullscreen) gameFrame.requestFullscreen();
    });

    renderChips();
    renderGrid();
  </script>
</body>
</html>
